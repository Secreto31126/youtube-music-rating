name: Publish Chrome Extension

on:
  push:
    branches: 
      - master

jobs:
  zip:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - run: zip -r YMR.zip * -x *.md -x .*/

  publish:
    needs: zip
    runs-on: ubuntu-latest
    
    steps:
    - uses: trmcnvn/chrome-addon@v2
      with:
        extension: ckmghhopnoeddmnlnploommajnnkhjjj
        zip: YMR.zip
        client-id: ${{ secrets.CHROME_CLIENT_ID }}
        client-secret: ${{ secrets.CHROME_CLIENT_SECRET }}
        refresh-token: ${{ secrets.CHROME_REFRESH_TOKEN }}
